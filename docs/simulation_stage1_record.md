# 手指模型MuJoCo仿真 - 第一阶段记录

## 项目概述
- **项目名称**: 手指机构MuJoCo仿真
- **仿真目标**: 建立手指机构的数字孪生模型，实现差动控制仿真
- **仿真平台**: MuJoCo
- **记录日期**: 2025年8月20日

## 第一阶段目标
- 建立可运行的基础仿真模型
- 验证基本运动学和动力学特性
- 为后续高级仿真奠定基础

## 可用物理实体清单

### 核心结构部件
| 部件名称 | 功能描述 | 仿真映射 | 状态 |
|---------|---------|---------|------|
| 舵机框架 | 基座/支撑结构 | worldbody base | ✅ 可用 |
| 舵机 | 驱动源1、2 | actuator + joint | ✅ 可用 |
| 指转部件 | 指根段/基节 | link_base body | ✅ 可用 |
| 指柱部件 | 中节 | link_mid body | ✅ 可用 |
| 指传动部件 | 差动/传动连杆 | link_trans body | ✅ 可用 |
| 指尖部件 | 末节 | link_tip body | ✅ 可用 |

### 连接部件
| 部件名称 | 功能描述 | 仿真映射 | 状态 |
|---------|---------|---------|------|
| 插销-1 | 指尖↔指柱连接 | hinge joint | ✅ 可建模 |
| 插销-2 | 指尖↔指传连接 | tendon约束 | ✅ 可建模 |
| 插销-3 | 指传↔球头链杆 | 简化为actuator | ⚠️ 需简化 |
| 插销-4 | 指传↔指转连接 | hinge joint | ✅ 可建模 |
| 插销-5 | 指转↔指柱连接 | hinge joint | ✅ 可建模 |
| 轴承 | 指转↔框架连接 | hinge joint | ✅ 可建模 |

### 缺失部件及处理方案
| 缺失部件 | 影响分析 | 处理方案 |
|---------|---------|---------|
| 球头链杆1、2 | 舵机输出与指传的机械连接 | 简化为直接actuator驱动 |
| 球头链杆连接细节 | 影响真实运动传递 | 用tendon约束模拟耦合效果 |

## 建模级别选择

### 选择级别：B（中级/差动功能）

**选择理由**：
1. ✅ 现有实体完全满足级别B要求
2. ✅ 能够体现差动机构的核心特性
3. ✅ 避免级别C的复杂闭环约束调试
4. ✅ 为后续升级到级别C保留接口

**级别B特点**：
- 建立指传部件为独立body
- 两个舵机独立驱动
- 通过tendon实现差动耦合
- 保持合理的计算效率

## 实现策略

### 1. 机构简化策略
```xml
<!-- 球头链杆简化 -->
原结构: 舵机 → 球头链杆 → 指传部件
简化后: 舵机 → 直接actuator → 指传hinge
```

### 2. 差动耦合实现
```python
# 控制层耦合方案
q_tip = f1(q_servo1, q_servo2, q_trans)
q_mid = f2(q_servo1, q_servo2, q_trans)

# 或使用tendon约束
<tendon>
    <spatial name="differential_coupling">
        <site site="s_servo1_effect"/>
        <site site="s_servo2_effect"/>
        <site site="s_trans_output"/>
    </spatial>
</tendon>
```

### 3. 关节配置
| 关节名称 | 类型 | 轴线 | 作用 |
|---------|------|------|------|
| j_servo1 | hinge | [0,1,0] | 舵机1输出 |
| j_servo2 | hinge | [0,1,0] | 舵机2输出 |
| j_base | hinge | [0,1,0] | 指转根部 |
| j_mid | hinge | [0,1,0] | 指柱根部 |
| j_tip | hinge | [0,1,0] | 指尖根部 |
| j_trans | hinge | [0,1,0] | 指传摆动 |

## 技术参数规划

### 质量与惯性估算
| 部件 | 材料 | 密度(kg/m³) | 估算质量(g) | 备注 |
|------|------|------------|------------|------|
| 舵机框架 | 铝合金 | 2700 | 20-30 | 集中质量 |
| 指转 | 塑料 | 1100 | 5-8 | 基节 |
| 指柱 | 塑料 | 1100 | 3-5 | 中节 |
| 指传动 | 塑料 | 1100 | 2-4 | 传动杆 |
| 指尖 | 塑料 | 1100 | 1-2 | 末节 |

### 关节参数
| 参数 | 建议值 | 说明 |
|------|--------|------|
| damping | 0.05-0.2 | 阻尼系数 |
| armature | 0.0001-0.001 | 电机惯量 |
| range | [-1.57, 1.57] | 关节范围(弧度) |

### 执行器参数
| 参数 | 建议值 | 说明 |
|------|--------|------|
| kp | 20-60 | 位置控制增益 |
| forcerange | ±0.8 | 最大力矩限制 |

## 仿真验证计划

### 阶段1：基础验证
- [ ] 模型加载无错误
- [ ] 关节运动范围正确
- [ ] 无碰撞穿透
- [ ] 基本稳定性测试

### 阶段2：功能验证
- [ ] 单舵机独立控制
- [ ] 双舵机差动效果
- [ ] 指尖轨迹跟踪
- [ ] 力矩输出合理

### 阶段3：性能验证
- [ ] 响应时间测试
- [ ] 稳定性边界测试
- [ ] 计算效率评估

## 风险评估与应对

### 技术风险
| 风险点 | 可能性 | 影响 | 应对措施 |
|--------|--------|------|---------|
| 惯性参数不准 | 中 | 运动失真 | 先用primitives估算 |
| 差动耦合不准 | 高 | 控制失效 | 多方案并行测试 |
| 数值不稳定 | 中 | 仿真爆炸 | 调整timestep和damping |

### 应对策略
1. **渐进式开发**：从简单到复杂，逐步添加功能
2. **参数调优**：预留参数调整接口，便于实时优化
3. **多方案备份**：控制层耦合和tendon耦合同时准备

## 下一步行动计划

### 立即行动项
1. **创建基础XML结构**：基于级别B的最小工作模型
2. **导入现有mesh文件**：将STEP文件转换为MuJoCo可用格式
3. **建立基础测试环境**：Python仿真脚本框架

### 短期目标（1-2周）
- [ ] 完成基础XML模型
- [ ] 实现单关节控制
- [ ] 验证基本运动学
- [ ] 建立参数调优流程

### 中期目标（1个月）
- [ ] 实现差动控制
- [ ] 完成性能验证
- [ ] 建立仿真-实验对比
- [ ] 准备升级到级别C

## 文档更新记录

| 版本 | 日期 | 更新内容 | 更新人 |
|------|------|---------|--------|
| v1.0 | 2025-08-20 | 初始记录，确定级别B方案 | 系统记录 |

---

**备注**: 本文档将随着仿真进展持续更新，每个阶段完成后将进行版本迭代。